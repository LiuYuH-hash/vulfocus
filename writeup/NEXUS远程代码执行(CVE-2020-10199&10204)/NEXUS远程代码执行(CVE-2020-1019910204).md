# NEXUS远程代码执行(CVE-2020-10199/10204)
## 漏洞描述
Nexus Repository Manager（NXRM）是美国Sonatype公司的一款Maven仓库管理器。 CVE-2020-10199的漏洞需要普通用户权限即可触发，而CVE-2020-10204则需要管理员权限。两个漏洞的触发原因均是不安全的执行EL表达式导致的。

## 影响版本
CVE-2020-10199：Nexus Repository Manager OSS/PRo <=3.21.1，需有低权限账号。
CVE-2020-10204：Nexus Repository Manager OSS/PRo <=3.21.1，需有管理员账号。

## 利用流程
1.访问地址：118.193.36.37:26423 	尝试得到弱口令admin/admin
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/NEXUS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2020-10199%2610204)/1.jpg)
2.下载可利用脚本:
```
https://github.com/zhzyker/CVE-2020-10199_POC-EXP
```
3.利用脚本：
```
python3 <filename> <url> <username> <password>
```
```
python3 cve-2020-10199_cmd.py http://118.193.36.37:26423 admin admin
```
```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/NEXUS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2020-10199%2610204)/2.jpg)
```
4.使用命令 ls /tmp得到flag：

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/NEXUS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2020-10199%2610204)/3.jpg)
